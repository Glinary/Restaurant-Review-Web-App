<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>View Profile</title>
    <link rel="stylesheet" href="ViewEstablishmentStyles.css" />
    <script
      src="https://kit.fontawesome.com/78bb10c051.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <header>
      <div class="RP-app-name">
        <h1>WhenInTaft</h1>
      </div>
      <div class="toggle-bars" id="mobile-menu">
        <div class="toggle"></div>
        <div class="toggle"></div>
        <div class="toggle"></div>
      </div>

      <div class="divide-this">

        
      </div>
      <div class="menu-bar">
        <div class="menu-list">
          <div class="part1">
            <a href="indexLog.html">HOME</a>
            <a href="restaurant.html">RESTAURANTS</a>
          </div>
          <div class="menu-line"></div>
          <div class="menu-bar2">
            <nav>
              <ul>
                <li>
                  <div class="view-profile">
                    <a href="" id="prof-page">VIEW PROFILE</a>
                    <img src="assets/anonymous_picture.png" id="prof-pic" />
                  </div>
                  <div class="dropdown-m">
                    <ul>
                      <li><a href="index.html">LOGOUT</a></li>
                    </ul>
                  </div>
                </li>
              </ul> 
            </nav>
          </div>
        </div>
      </div>
    </header>
     <div class="search-container">
        <input
          type="text"
          placeholder="search here"
          name="searchBar"
          id="searchBar"
        /><img src="assets/searchbutton.png" alt="" />
      </div>
      <div class="search-line"></div>
      <!-- end of header menu -->

      <div class="search-container2">
        <input
          type="text"
          placeholder="search here"
          name="searchBar"
          id="searchBar"
        /><img src="assets/searchbutton.png" alt="" />
      </div>
      
    <!-- end of header menu -->

    <div id="profilee">
      <div class="box">
        <div class="box-a">
          <a href="#profile" class="aboutme">About Me</a>
          <a href="#review" class="aboutme">Reviews</a>
          <a href="#" class="aboutme">Gallery</a>
        </div>
      </div>
      <div class="yohoo">
        <div class="profile-section" id="profile">
            <div class="profile-pictures-section">
            <div class="profile-picture">
                <img src="assets/avatar.webp" />
            </div>

            <div class="smaller-profiles">
                <img src="assets/avatar.webp" />
                <img src="assets/avatar.webp" />
                <img src="assets/avatar.webp" />
            </div>
            </div>
            <div class="profile-description">
            <h1>Tinuhog ni Benny</h1>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum
            </p>
            </div>
        </div>
        <div class="edit-profile-section">
          <h4>Edit Profile</h4>
          <img src="assets/book_icon.png" />
          </div>
        <div class="top-reviews-section">
            <div class="top-label-and-navigator" id="review">
                <h3>Top Reviews</h3>
            </div>
            <div class="top-reviews-content-container">
                <div class="top-reviews-left-container">
                  <div class="top-left">
                    <div class="top-reviews-user-details">
                      <img
                        src="assets/anonymous_picture.png"
                        class="top-reviews-profile-pic"
                      />
                    </div>
                    <div class="top-further-details">
                      <div class="top-name">
                        <a class="top-firstname" href="#">Harry Potter</a>
                      </div>
                      <div class="top-others">
                        <p class="top-review-count">9 Reviews</p>
                      </div>
                    </div>
                    <div id="top-reaction">
                      <div id="top-helpful">
                        <i class="fa-solid fa-thumbs-up" style="color: #000000"></i>
                      </div><span class="top-count" value="14">14</span>
                      <div id="top-unhelpful">
                        <i class="fa-solid fa-thumbs-down" style="color: #000000;"></i></i>
                      </div><span class="top-count" value="1">1</span>
                    </div>
                  </div>
                  <div class="top-overall-stars">
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <p>stars</p>
                  </div>
                  <div class="review">
                    <p class="top-review-paragraph">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                      eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </p>
                  </div>
                </div>
        
                <div class="top-reviews-pictures">
                  <img src="assets/starbucks.jpg" class="top-review-image" />
                  <img src="assets/starbucks.jpg" class="top-review-image" />
                </div>
                <div id="EditMenu">
                  <div id="editBar">
                    <div id="editBars"></div>
                    <div id="editBars"></div>
                    <div id="editBars"></div>
                  </div>
                  <div id="EditNav">
                    <ul>
                      <li><a href="#">Edit</a></li>
                      <li><a href="#">Delete</a></li>
                      <li><a href="#">Reply</a></li>
                    </ul>
                  </div>
                </div>
            </div>

            <div class="top-reviews-content-container">
                <div class="top-reviews-left-container">
                  <div class="top-left">
                    <div class="top-reviews-user-details">
                      <img
                        src="assets/anonymous_picture.png"
                        class="top-reviews-profile-pic"
                      />
                    </div>
                    <div class="top-further-details">
                      <div class="top-name">
                        <a class="top-firstname" href="#">Harry Potter</a>
                      </div>
                      <div class="top-others">
                        <p class="top-review-count">9 Reviews</p>
                      </div>
                    </div>
                    <div id="top-reaction">
                      <div id="top-helpful">
                        <i class="fa-solid fa-thumbs-up" style="color: #000000"></i>
                      </div><span class="top-count" value="14">14</span>
                      <div id="top-unhelpful">
                        <i class="fa-solid fa-thumbs-down" style="color: #000000;"></i></i>
                      </div><span class="top-count" value="1">1</span>
                    </div>
                  </div>
                  <div class="top-overall-stars">
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <div id="Ostar"><i class="fa-regular fa-star"></i></div>
                    <p>stars</p>
                  </div>
                  <div class="review">
                    <p class="top-review-paragraph">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                      eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </p>
                  </div>
                </div>
        
                <div class="top-reviews-pictures">
                  <img src="assets/starbucks.jpg" class="top-review-image" />
                  <img src="assets/starbucks.jpg" class="top-review-image" />
                </div>
                <div id="EditMenu">
                  <div id="editBar">
                    <div id="editBars"></div>
                    <div id="editBars"></div>
                    <div id="editBars"></div>
                  </div>
                  <div id="EditNav">
                    <ul>
                      <li><a href="#">Edit</a></li>
                      <li><a href="#">Delete</a></li>
                      <li><a href="#">Reply</a></li>
                    </ul>
                  </div>
                </div>
            </div>
            
        </div>
      </div>

      <div class="box"></div>
    </div>

    <div class="reviews-section">
      <div class="label-and-navigator" id="review">
        <h3>User's Reviews</h3>
        <h4>View All</h4>
      </div>
      <div class="reviews-content-container">
        <div class="reviews-left-container">
          <div class="left">
            <div class="reviews-user-details">
              <img
                src="assets/anonymous_picture.png"
                class="reviews-profile-pic"
              />
            </div>
            <div class="further-details">
              <div class="name">
                <a class="firstname" href="#">Harry Potter</a>
              </div>
              <div class="others">
                <p class="review-count">9 Reviews</p>
              </div>
            </div>
            <div id="reaction">
              <div id="helpful">
                <i class="fa-solid fa-thumbs-up" style="color: #000000"></i>
              </div><span class="count" value="14">14</span>
              <div id="unhelpful">
                <i class="fa-solid fa-thumbs-down" style="color: #000000;"></i></i>
              </div><span class="count" value="1">1</span>
            </div>
          </div>
          <div class="overall-stars">
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <p>stars</p>
          </div>
          <div class="review">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua.
            </p>
          </div>
        </div>

        <div class="reviews-pictures">
          <img src="assets/starbucks.jpg" class="review-image" />
          <img src="assets/starbucks.jpg" class="review-image" />
        </div>
        <div id="EditMenu">
          <div id="editBar">
            <div id="editBars"></div>
            <div id="editBars"></div>
            <div id="editBars"></div>
          </div>
          <div id="EditNav">
            <ul>
              <li><a href="#">Edit</a></li>
              <li><a href="#">Delete</a></li>
              <li><a href="#">Reply</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="reviews-content-container">
        <div class="reviews-left-container">
          <div class="left">
            <div class="reviews-user-details">
              <img
                src="assets/anonymous_picture.png"
                class="reviews-profile-pic"
              />
            </div>
            <div class="further-details">
              <div class="name">
                <a class="firstname" href="#">Harry Potter</a>
              </div>
              <div class="others">
                <p class="review-count">9 Reviews</p>
               
              </div> 
            </div>
            <div id="reaction">
              <div id="helpful">
                <i class="fa-solid fa-thumbs-up" style="color: #000000"></i>
              </div><span class="count" value="14">14</span>
              <div id="unhelpful">
                <i class="fa-solid fa-thumbs-down" style="color: #000000;"></i></i>
              </div><span class="count" value="1">1</span>
            </div>
          </div>
          <div class="overall-stars">
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <div id="Ostar"><i class="fa-regular fa-star"></i></div>
            <p>stars</p>
          </div>
          <div class="review">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua.
            </p>
          </div>
        </div>

        <div class="reviews-pictures">
          <img src="assets/starbucks.jpg" class="review-image" />
          <img src="assets/starbucks.jpg" class="review-image" />
        </div>
        <div id="EditMenu">
          <div id="editBar">
            <div id="editBars"></div>
            <div id="editBars"></div>
            <div id="editBars"></div>
          </div>
          <div id="EditNav">
            <ul>
              <li><a href="#">Edit</a></li>
              <li><a href="#">Delete</a></li>
              <li><a href="#">Reply</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="gallery-section">
      <div class="gallery-container">
        <h3>Gallery</h3>
        
        <div class="gallery-pictures">
          <img src="assets/starbucks.jpg" class="gallery-image"/>
          <img src="assets/starbucks.jpg" class="gallery-image"/>
          <img src="assets/starbucks.jpg" class="gallery-image"/>
          <img src="assets/starbucks.jpg" class="gallery-image"/>
        </div>
      </div>
    </div>
    
  </body>
  <script>
    const reviews = document.querySelectorAll(".review");
    const times = document.querySelectorAll(".review").length;
    const editBar = document.querySelectorAll("#EditMenu");
    const reactionH = document.querySelectorAll("#helpful");
    const reactionU = document.querySelectorAll("#unhelpful");
    const reaction = document.querySelectorAll("#reaction");
    const body = document.getElementsByTagName("BODY")[0];
    let arrH = [];
    let arrU = [];
    let currLike = [];
    let currDLike = [];
    let flag = true;
    let flag2 = true;

    const menu = document.querySelector("#mobile-menu");
    const menuLinks = document.querySelector(".menu-bar");
    const userPage = document.querySelector("#prof-page");
    const userPic = document.querySelector("#prof-pic");
    const searchBar = document.querySelector(".search-container");

    menu.addEventListener("click", function () {
      menu.classList.toggle("is-active");
      menuLinks.classList.toggle("active");
      searchBar.classList.toggle("active");
    });
    userPage.addEventListener("mouseover", function () {
      userPic.classList.toggle("hovered");
    });
    userPage.addEventListener("mouseout", function () {
      userPic.classList.toggle("hovered");
    });

    // more/less event listener
    for (let i = 0; i < times; i = i + 1) {
      revs = reviews[i];
      // assign value of text shown here (change 80)
      revs.innerText = truncateText(revs, 80);
      revs.innerHTML += '<span id="more">&nbsp;see more</span>';
    }

    // https://stackoverflow.com/a/63162630
    function truncateText(selector, maxLength) {
      var element = selector;
      truncated = element.innerText;
      truncate = truncated;

      if (truncated.length > maxLength) {
        truncated = truncated.substr(0, maxLength) + "...";
      }
      console.log("trucated: ", truncated);
      console.log(element, "Successfully Truncated");
      return truncated;
    }

    //https://stackoverflow.com/a/62555388
    reviews.forEach((cell) =>
      cell.addEventListener("click", function () {
        if (flag == true) {
          cell.innerHTML = truncate;
          cell.innerHTML += '<span id="more">&nbsp;see less</span>';
          flag = false;
        } else if (flag == false) {
          cell.innerHTML = truncated;
          cell.innerHTML += '<span id="more">&nbsp;see more</span>';
          flag = true;
        }
      })
    );
    // more/less event listener end...
    
    // editBar div event listener (when clicked delete/edit shows)
    editBar.forEach((cell) =>
      cell.addEventListener("click", function () {
        if (flag2 == true) {
          console.log(cell);
          cld = cell.lastElementChild;
          console.log(cld);
          cld.style.display = "block";
          flag2 = false;
        } else if (flag2 == false) {
          console.log(cell);
          cld = cell.lastElementChild;
          console.log(cld);
          cld.style.display = "none";
          flag2 = true;
        }
      })
    );

    // click everywhere event listener
    //https://stackoverflow.com/a/33657471
    body.addEventListener(
      "click",
      function () {
        if (flag2 == false) {
          cld.style.display = "none";
          flag2 = true;
        }
      },
      false
    );
    // excludes editbar 
    editBar.forEach(
      (cell) =>
        cell.addEventListener("click", function (ev) {
          ev.stopPropagation(); //this is important! If removed, you'll get both alerts
        }),
      false
    );
    // excludes reaction div
    reactionH.forEach(
      (cell) =>
        cell.addEventListener("click", function (ev) {
          ev.stopPropagation(); //this is important! If removed, you'll get both alerts
        }),
      false
    );
    

    
    // console.log(reaction[1]);

    /*Initialize Reaction Button Data*/
    for (let i = 0; i < reactionH.length; i++){
      arrH.push(0);
      arrU.push(0);
      currLike.push(parseInt(reactionH[i].nextSibling.attributes[1].value));
      currDLike.push(parseInt(reactionU[i].nextSibling.attributes[1].value));

    }
    /**! CHECKER
    console.log(arrH);
    console.log(arrU);
    console.log(currLike);
    console.log(currDLike);
    */

    for(let j = 0; j < reactionH.length; j++) {
      reactionH[j].addEventListener("click", function(){
        if (arrU[j] == 0 && arrH[j] == 0){
            reactionH[j].innerHTML = "<i class=\"fa-solid fa-thumbs-up\" style=\"color: #087d6f;\"></i>"
            currLike[j] += 1 ;
            reactionH[j].nextSibling.innerText = currLike[j]
            arrH[j] = 1;
            console.log(arrH);
        } else if (arrU[j] == 0 && arrH[j] == 1){
            reactionH[j].innerHTML = "<i class=\"fa-solid fa-thumbs-up\" style=\"color: #000000\"></i>"
            currLike[j] -= 1 ;
            reactionH[j].nextSibling.innerText = currLike[j];
            arrH[j] = 0;
            console.log(arrH);
          } 
      })
    }

    for(let k = 0; k < reactionU.length; k++) {
      reactionU[k].addEventListener("click", function(){
          if (arrH[k] == 0 && arrU[k] == 0) {
            reactionU[k].innerHTML = "<i class=\"fa-solid fa-thumbs-down\" style=\"color: #087d6f;\"></i>"
            currDLike[k] += 1 ;
            reactionU[k].nextSibling.innerText = currDLike[k];
            arrU[k] = 1;
            console.log(arrH);
          } 
          else if (arrH[k] == 0 && arrU[k] == 1){
            reactionU[k].innerHTML = "<i class=\"fa-solid fa-thumbs-down\" style=\"color: #000000\"></i>"
            currDLike[k] -= 1 ;
            reactionU[k].nextSibling.innerText = currDLike[k];
            arrU[k] = 0;
            console.log(arrU);
          }
      })
    }
  </script>
</html>
